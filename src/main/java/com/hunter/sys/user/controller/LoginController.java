package com.hunter.sys.user.controller;import com.google.common.base.Strings;import com.hunter.base.vo.ApiResponseVo;import com.hunter.common.constant.ErrorCodeEnum;import com.hunter.common.constant.UserTypeEnum;import com.hunter.common.util.EncryptUtil;import com.hunter.sys.user.entity.SysUser;import com.hunter.sys.user.service.SysUserService;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Controller;import org.springframework.ui.ModelMap;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.ResponseBody;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpSession;import static com.hunter.common.constant.ErrorCodeEnum.PARAM_REQUIRED;/** * Created by zhangchaolong on 16/6/16. */@Controller@RequestMapping("/sys/login")public class LoginController {    @Autowired    private SysUserService sysUserService;    /**     * 登录     *     * @param request     * @param modelMap     * @return     * @throws Exception     */    @RequestMapping(value = "/login",            produces = "application/json;charset=UTF-8")    @ResponseBody    public String login(HttpServletRequest request, ModelMap modelMap) {        String phone = request.getParameter("phone");        String pwd = request.getParameter("password");        if (Strings.isNullOrEmpty(phone)) {            return ApiResponseVo.error(PARAM_REQUIRED.getCode(), "手机号不能为空");        }        if (Strings.isNullOrEmpty(pwd)) {            return ApiResponseVo.error(PARAM_REQUIRED.getCode(), "密码不能为空");        }        //验证密码        SysUser user = sysUserService.findOneByTypeAndPhone(UserTypeEnum.ADMIN.getCode() + "", phone);        if (user == null) {            return ApiResponseVo.error(ErrorCodeEnum.NO_ROLE.getCode(), "该用户不存在");        }        if (!user.getPassword().equals(EncryptUtil.encodeByMD5(pwd))) {            return ApiResponseVo.error(ErrorCodeEnum.NO_ROLE.getCode(), "密码不正确,请重新输入");        }        HttpSession session = request.getSession();        session.setAttribute("user", user);        return ApiResponseVo.success(null);    }    /**     * 获取首页     *     * @param request     * @param modelMap     * @return     * @throws Exception     */    @RequestMapping("/getHomePage")    public String getHomePage(HttpServletRequest request, ModelMap modelMap) {        return "/login/homePage";    }    /**     * 获取主页     *     * @param request     * @param modelMap     * @return     * @throws Exception     */    @RequestMapping("/getMainPage")    public String getMainPage(HttpServletRequest request, ModelMap modelMap) {        return "/login/main";    }}